Files already downloaded and verified
Files already downloaded and verified
wandb: logging graph, to disable use `wandb.watch(log_graph=False)`

Epoch 1: 100%|██████████| 25/25 [00:54<00:00,  2.19s/it]
Got on test set --> Accuracy: 21.750 and Loss: 2.280
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 2: 100%|██████████| 25/25 [00:01<00:00, 14.83it/s]
Got on test set --> Accuracy: 29.270 and Loss: 2.201
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 3:   0%|          | 0/25 [00:00<?, ?it/s]

Epoch 3: 100%|██████████| 25/25 [00:01<00:00, 15.46it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 4: 100%|██████████| 25/25 [00:01<00:00, 14.81it/s]
Got on test set --> Accuracy: 32.670 and Loss: 2.066
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 5:  20%|██        | 5/25 [00:00<00:02,  7.21it/s]

Epoch 5: 100%|██████████| 25/25 [00:01<00:00, 14.30it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 6:  80%|████████  | 20/25 [00:01<00:00, 18.18it/s]
Epoch 6: 100%|██████████| 25/25 [00:01<00:00, 15.30it/s]
Epoch 7:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now

Epoch 7: 100%|██████████| 25/25 [00:01<00:00, 15.18it/s]
Got on test set --> Accuracy: 37.630 and Loss: 1.895
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 8:  72%|███████▏  | 18/25 [00:01<00:00, 19.26it/s]
Epoch 8: 100%|██████████| 25/25 [00:01<00:00, 14.75it/s]
Epoch 9:   4%|▍         | 1/25 [00:00<00:15,  1.55it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint

Epoch 9: 100%|██████████| 25/25 [00:01<00:00, 16.11it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 10: 100%|██████████| 25/25 [00:01<00:00, 14.37it/s]
Got on test set --> Accuracy: 41.650 and Loss: 1.742
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 11:   4%|▍         | 1/25 [00:00<00:14,  1.60it/s]

Epoch 11: 100%|██████████| 25/25 [00:01<00:00, 16.00it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 12: 100%|██████████| 25/25 [00:01<00:00, 16.36it/s]
Got on test set --> Accuracy: 43.840 and Loss: 1.663
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 13:  24%|██▍       | 6/25 [00:00<00:02,  8.80it/s]

Epoch 13: 100%|██████████| 25/25 [00:01<00:00, 15.19it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 14: 100%|██████████| 25/25 [00:01<00:00, 16.33it/s]
Got on test set --> Accuracy: 45.830 and Loss: 1.591
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 15:  24%|██▍       | 6/25 [00:00<00:02,  8.74it/s]

Epoch 15: 100%|██████████| 25/25 [00:01<00:00, 15.21it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 16:  92%|█████████▏| 23/25 [00:01<00:00, 21.18it/s]
Epoch 16: 100%|██████████| 25/25 [00:01<00:00, 14.15it/s]
Epoch 17:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint

Epoch 17: 100%|██████████| 25/25 [00:01<00:00, 16.84it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 18: 100%|██████████| 25/25 [00:01<00:00, 17.08it/s]
Got on test set --> Accuracy: 49.730 and Loss: 1.477
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 19:  12%|█▏        | 3/25 [00:00<00:04,  5.29it/s]

Epoch 19: 100%|██████████| 25/25 [00:01<00:00, 16.47it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 20: 100%|██████████| 25/25 [00:01<00:00, 15.90it/s]
Got on test set --> Accuracy: 51.150 and Loss: 1.431
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 21:   4%|▍         | 1/25 [00:00<00:13,  1.73it/s]

Epoch 21: 100%|██████████| 25/25 [00:01<00:00, 15.85it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 22: 100%|██████████| 25/25 [00:01<00:00, 15.68it/s]
Got on test set --> Accuracy: 52.700 and Loss: 1.390
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 23:   4%|▍         | 1/25 [00:00<00:19,  1.25it/s]

Epoch 23: 100%|██████████| 25/25 [00:01<00:00, 14.48it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 24: 100%|██████████| 25/25 [00:01<00:00, 15.68it/s]
Got on test set --> Accuracy: 54.100 and Loss: 1.347
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 25:  16%|█▌        | 4/25 [00:00<00:03,  5.44it/s]

Epoch 25: 100%|██████████| 25/25 [00:01<00:00, 14.56it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 26:  92%|█████████▏| 23/25 [00:01<00:00, 16.11it/s]
Epoch 26: 100%|██████████| 25/25 [00:01<00:00, 14.29it/s]
Epoch 27:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now

Epoch 27: 100%|██████████| 25/25 [00:01<00:00, 14.42it/s]
Got on test set --> Accuracy: 55.860 and Loss: 1.290
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 28:  64%|██████▍   | 16/25 [00:01<00:00, 24.45it/s]
Epoch 28: 100%|██████████| 25/25 [00:01<00:00, 15.91it/s]
Epoch 29:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now

Epoch 29: 100%|██████████| 25/25 [00:01<00:00, 17.19it/s]
Got on test set --> Accuracy: 57.090 and Loss: 1.255
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 30: 100%|██████████| 25/25 [00:01<00:00, 16.04it/s]
Got on test set --> Accuracy: 57.490 and Loss: 1.243
Epoch 31:   4%|▍         | 1/25 [00:00<00:14,  1.71it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint

Epoch 31: 100%|██████████| 25/25 [00:01<00:00, 17.18it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 32: 100%|██████████| 25/25 [00:01<00:00, 16.56it/s]
Got on test set --> Accuracy: 58.580 and Loss: 1.207
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 33:  56%|█████▌    | 14/25 [00:01<00:00, 18.86it/s]
Epoch 33: 100%|██████████| 25/25 [00:01<00:00, 15.54it/s]
Epoch 34:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint

Epoch 34: 100%|██████████| 25/25 [00:01<00:00, 16.86it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 35: 100%|██████████| 25/25 [00:01<00:00, 16.67it/s]
Got on test set --> Accuracy: 59.970 and Loss: 1.168
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 36:   4%|▍         | 1/25 [00:00<00:18,  1.28it/s]

Epoch 36: 100%|██████████| 25/25 [00:01<00:00, 15.17it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 37: 100%|██████████| 25/25 [00:01<00:00, 16.38it/s]
Got on test set --> Accuracy: 60.830 and Loss: 1.143
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 38:  20%|██        | 5/25 [00:00<00:02,  7.42it/s]
Epoch 38: 100%|██████████| 25/25 [00:01<00:00, 15.75it/s]
Epoch 39:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now

Epoch 39: 100%|██████████| 25/25 [00:01<00:00, 16.42it/s]
Got on test set --> Accuracy: 61.600 and Loss: 1.119
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 40:  72%|███████▏  | 18/25 [00:01<00:00, 24.75it/s]
Epoch 40: 100%|██████████| 25/25 [00:01<00:00, 17.59it/s]
Epoch 41:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint

Epoch 41: 100%|██████████| 25/25 [00:01<00:00, 15.69it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 42: 100%|██████████| 25/25 [00:01<00:00, 16.64it/s]
Got on test set --> Accuracy: 62.330 and Loss: 1.090
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 43:  16%|█▌        | 4/25 [00:00<00:03,  6.22it/s]
Epoch 43: 100%|██████████| 25/25 [00:01<00:00, 16.50it/s]
Epoch 44:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now

Epoch 44: 100%|██████████| 25/25 [00:01<00:00, 16.41it/s]
Got on test set --> Accuracy: 63.180 and Loss: 1.071
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 45:  24%|██▍       | 6/25 [00:00<00:02,  7.99it/s]
Epoch 45: 100%|██████████| 25/25 [00:01<00:00, 15.23it/s]
Epoch 46:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now

Epoch 46: 100%|██████████| 25/25 [00:01<00:00, 14.69it/s]
Got on test set --> Accuracy: 63.440 and Loss: 1.054
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 47:  32%|███▏      | 8/25 [00:01<00:01, 10.78it/s]
Epoch 47: 100%|██████████| 25/25 [00:01<00:00, 14.84it/s]
Epoch 48:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now

Epoch 48: 100%|██████████| 25/25 [00:01<00:00, 13.69it/s]
Got on test set --> Accuracy: 64.230 and Loss: 1.038
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 49:  44%|████▍     | 11/25 [00:01<00:00, 15.59it/s]
Epoch 49: 100%|██████████| 25/25 [00:01<00:00, 16.15it/s]
Epoch 50:   0%|          | 0/25 [00:00<?, ?it/s]

Epoch 50: 100%|██████████| 25/25 [00:01<00:00, 14.91it/s]
Got on test set --> Accuracy: 64.420 and Loss: 1.029
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 51:  60%|██████    | 15/25 [00:01<00:00, 20.55it/s]
Epoch 51: 100%|██████████| 25/25 [00:01<00:00, 14.91it/s]
Epoch 52:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now

Epoch 52: 100%|██████████| 25/25 [00:01<00:00, 13.52it/s]
Got on test set --> Accuracy: 64.980 and Loss: 1.008
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 53:  40%|████      | 10/25 [00:01<00:01, 14.30it/s]
Epoch 53: 100%|██████████| 25/25 [00:01<00:00, 15.31it/s]
Epoch 54:   0%|          | 0/25 [00:00<?, ?it/s]

Epoch 54: 100%|██████████| 25/25 [00:01<00:00, 15.54it/s]
Got on test set --> Accuracy: 65.360 and Loss: 0.996
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 55:  44%|████▍     | 11/25 [00:01<00:00, 14.06it/s]
Epoch 55: 100%|██████████| 25/25 [00:01<00:00, 14.69it/s]
Epoch 56:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now

Epoch 56: 100%|██████████| 25/25 [00:01<00:00, 14.48it/s]
Got on test set --> Accuracy: 65.670 and Loss: 0.988
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 57:  16%|█▌        | 4/25 [00:00<00:03,  5.61it/s]
Epoch 57: 100%|██████████| 25/25 [00:01<00:00, 15.83it/s]
Epoch 58:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now

Epoch 58: 100%|██████████| 25/25 [00:01<00:00, 15.15it/s]
Got on test set --> Accuracy: 66.020 and Loss: 0.977
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 59:   0%|          | 0/25 [00:00<?, ?it/s]

Epoch 59: 100%|██████████| 25/25 [00:01<00:00, 13.36it/s]
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 60: 100%|██████████| 25/25 [00:01<00:00, 16.29it/s]
Got on test set --> Accuracy: 66.450 and Loss: 0.967
Epoch 61:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now

Epoch 61: 100%|██████████| 25/25 [00:01<00:00, 14.69it/s]
Got on test set --> Accuracy: 66.530 and Loss: 0.959
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 62:  72%|███████▏  | 18/25 [00:01<00:00, 17.82it/s]
Epoch 62: 100%|██████████| 25/25 [00:01<00:00, 14.78it/s]
Epoch 63:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now

Epoch 63: 100%|██████████| 25/25 [00:01<00:00, 15.14it/s]
Got on test set --> Accuracy: 67.250 and Loss: 0.948
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint
Epoch 64:  72%|███████▏  | 18/25 [00:01<00:00, 21.70it/s]
Epoch 64: 100%|██████████| 25/25 [00:01<00:00, 15.70it/s]
Epoch 65:   0%|          | 0/25 [00:00<?, ?it/s]

Epoch 65: 100%|██████████| 25/25 [00:01<00:00, 15.94it/s]
Got on test set --> Accuracy: 67.180 and Loss: 0.941
=> Saving checkpoint
Epoch 66:  68%|██████▊   | 17/25 [00:01<00:00, 22.07it/s]
Epoch 66: 100%|██████████| 25/25 [00:01<00:00, 14.47it/s]
Epoch 67:   0%|          | 0/25 [00:00<?, ?it/s]
=> Best Model found ! Don't Stop Me Now

Epoch 67: 100%|██████████| 25/25 [00:01<00:00, 16.53it/s]
Got on test set --> Accuracy: 67.540 and Loss: 0.931
=> Best Model found ! Don't Stop Me Now
=> Saving checkpoint

Epoch 68: 100%|██████████| 25/25 [00:01<00:00, 15.44it/s]
Traceback (most recent call last):
  File "C:\Users\Roberto\PycharmProjects\DeepLearningApplications\Lab3-OOD\Exercise 1.1 Build a simple OOD detection pipeline\train.py", line 149, in <module>
    main(wab, check_dir, w_dir, dev, n_workers)
  File "C:\Users\Roberto\PycharmProjects\DeepLearningApplications\Lab3-OOD\Exercise 1.1 Build a simple OOD detection pipeline\train.py", line 77, in main
    test_loss, test_accuracy, id_score, ood_score = eval_fn(test_loader,fake_loader, model, criterion, metric_collection, device)
                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Roberto\PycharmProjects\DeepLearningApplications\Lab3-OOD\Exercise 1.1 Build a simple OOD detection pipeline\utils.py", line 117, in eval_fn
    running_loss += loss.item()
                    ^^^^^^^^^^^
RuntimeError: CUDA error: unknown error
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
